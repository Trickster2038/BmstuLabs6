
machinelearningmastery.ru
Прогнозирование временных рядов как контролируемое обучение
www.machinelearningmastery.ru
11-16 minutes

Дата публикации 2016-12-05	

Прогнозирование временных рядов можно представить как контролируемую проблему обучения.

Это переформирование ваших данных временных рядов позволяет вам получить доступ к набору стандартных линейных и нелинейных алгоритмов машинного обучения для вашей задачи.

В этом посте вы узнаете, как можно переформулировать проблему временных рядов как проблему контролируемого обучения для машинного обучения. Прочитав этот пост, вы узнаете:

    Что такое контролируемое обучение и как оно является основой для всех алгоритмов интеллектуального машинного обучения с прогностическим моделированием.
    Метод скользящего окна для формирования набора данных временного ряда и как его использовать.
    Как использовать скользящее окно для многомерных данных и многошагового прогнозирования.

Давайте начнем.

Контролируемое машинное обучение

Большая часть практического машинного обучения использует контролируемое обучение.

Контролируемое обучение - это когда у вас есть входные переменные (Икс) и выходная переменная (Y) и вы используете алгоритм, чтобы узнать функцию отображения от входа к выходу.

Y = f(X)

Цель состоит в том, чтобы аппроксимировать реальное базовое отображение настолько хорошо, чтобы при появлении новых входных данных (Икс), вы можете предсказать выходные переменные (Y) для этих данных.

Ниже приведен надуманный пример контролируемого набора данных обучения, где каждая строка представляет собой наблюдение, состоящее из одной входной переменной (Икс) и одна выходная переменная для прогнозирования (Y).

X, y
5, 0.9
4, 0.8
5, 1.0
3, 0.7
4, 0.9

Это называется контролируемым обучением, поскольку процесс обучения алгоритма из набора обучающих данных можно рассматривать как учителя, контролирующего учебный процесс.

Мы знаем правильные ответы; алгоритм итеративно делает прогнозы на обучающих данных и корректируется путем внесения обновлений. Обучение останавливается, когда алгоритм достигает приемлемого уровня производительности.

Проблемы обучения под наблюдением могут быть далее сгруппированы в проблемы регрессии и классификации.

    классификация: Проблема классификации заключается в том, что выходной переменной является категория, например:красный" а также "синий" или же "болезнь" а также "нет болезни«.
    регрессия: Проблема регрессии, когда выходная переменная представляет собой реальное значение, такое как «долларов" или же "вес. Придуманный выше пример является проблемой регрессии.

Скользящее окно для данных временных рядов

Данные временного ряда можно сформулировать как контролируемое обучение.

Учитывая последовательность чисел для набора данных временного ряда, мы можем реструктурировать данные, чтобы они выглядели как контролируемая проблема обучения. Мы можем сделать это, используя предыдущие временные шаги в качестве входных переменных и использовать следующий временной шаг в качестве выходных переменных.

Давайте сделаем это на примере. Представьте, что у нас есть временной ряд следующим образом:

time, measure
1, 100
2, 110
3, 108
4, 115
5, 120

Мы можем реструктурировать этот набор данных временных рядов как контролируемую проблему обучения, используя значение на предыдущем временном шаге, чтобы предсказать значение на следующем временном шаге. Таким образом, реорганизация набора данных временных рядов будет выглядеть следующим образом:

X, y
?, 100
100, 110
110, 108
108, 115
115, 120
120, ?

Взгляните на приведенный выше преобразованный набор данных и сравните его с исходным временным рядом. Вот некоторые наблюдения:

    Мы можем видеть, что предыдущий шаг по времени является входом (Икс) и следующий шаг по времени является выходным (Y) в нашей контролируемой проблеме обучения.
    Мы можем видеть, что порядок между наблюдениями сохраняется и должен сохраняться при использовании этого набора данных для обучения контролируемой модели.
    Мы можем видеть, что у нас нет предыдущего значения, которое мы могли бы использовать для предсказания первого значения в последовательности. Мы удалим эту строку, так как не можем ее использовать.
    Мы также можем видеть, что у нас нет известного следующего значения, которое можно было бы предсказать для последнего значения в последовательности. Мы можем захотеть удалить это значение во время обучения нашей контролируемой модели.

Использование предыдущих временных шагов для прогнозирования следующего временного шага называется методом скользящего окна. Для краткости, это может быть названо методом окна в некоторой литературе. В статистике и анализе временных рядов это называется методом отставания или отставания.

Количество предыдущих временных шагов называется шириной окна или размером лага.

Это скользящее окно является основой того, как мы можем превратить любой набор данных временного ряда в контролируемую проблему обучения. Из этого простого примера мы можем заметить несколько вещей:

    Мы можем видеть, как это может работать, чтобы превратить временной ряд в регрессионную или классифицированную задачу обучения под наблюдением для значений реального ряда или маркированных значений временного ряда.
    Мы можем видеть, как после того, как набор данных временного ряда подготовлен таким образом, что любой из стандартных линейных и нелинейных алгоритмов машинного обучения может быть применен, при условии, что порядок строк сохраняется.
    Мы видим, как можно увеличить ширину скользящего окна, чтобы включить больше предыдущих временных шагов.
    Мы можем видеть, как подход со скользящим окном может использоваться для временных рядов, имеющих более одного значения, или так называемых многомерных временных рядов.

Мы рассмотрим некоторые из этих применений скользящего окна, начиная с его использования для обработки временных рядов с более чем одним наблюдением на каждом временном шаге, называемым многомерным временным рядом.
Скользящее окно с многомерными данными временных рядов

Имеет значение количество наблюдений, записанных для данного времени в наборе данных временного ряда.

Традиционно используются разные имена:

    Одномерный временной рядЭто наборы данных, в которых в каждый момент времени наблюдается только одна переменная, например, температура каждый час. Пример в предыдущем разделе представляет собой одномерный набор данных временных рядов.
    Многомерный временной ряд: Это наборы данных, в которых одновременно наблюдаются две или более переменных.

Большинство методов анализа временных рядов и даже книги по этой теме фокусируются на одномерных данных. Это потому, что это самый простой для понимания и работы. С многомерными данными часто сложнее работать. Сложнее моделировать, и часто многие классические методы неэффективны.

    Анализ многомерных временных рядов учитывает одновременно несколько временных рядов. … В общем, это намного сложнее, чем одномерный анализ временных рядов

- Страница 1,Анализ многомерных временных рядов: с R и финансовыми приложениями,

Лучшее место для использования машинного обучения для временных рядов - это место, где рушатся классические методы. Это может быть со сложными одномерными временными рядами и более вероятно с многомерными временными рядами, учитывая дополнительную сложность.

Ниже приведен еще один рабочий пример, чтобы сделать метод скользящего окна конкретным для многомерных временных рядов.

Предположим, у нас есть изобретенный многомерный набор данных временного ряда с двумя наблюдениями на каждом временном шаге. Давайте также предположим, что нас интересует только прогнозированиеmeasure2,

time, measure1, measure2
1, 0.2, 88
2, 0.5, 89
3, 0.7, 87
4, 0.4, 88
5, 1.0, 90

Мы можем переформировать этот набор данных временных рядов как контролируемую задачу обучения с шириной окна, равной единице.

Это означает, что мы будем использовать предыдущие значения временного шагаmeasure1а такжеmeasure2, У нас также будет доступно значение шага следующего времени дляmeasure1, Затем мы прогнозируем значение следующего временного шагаmeasure2,

Это даст нам 3 входных функции и одно выходное значение для прогнозирования для каждого шаблона обучения.

X1, X2, X3, y
?, ?, 0.2 , 88
0.2, 88, 0.5, 89
0.5, 89, 0.7, 87
0.7, 87, 0.4, 88
0.4, 88, 1.0, 90
1.0, 90, ?, ?

Мы можем видеть, что, как в приведенном выше примере одномерного временного ряда, нам может потребоваться удалить первый и последний ряды, чтобы обучить нашу контролируемую модель обучения.

Этот пример поднимает вопрос о том, что если бы мы хотели предсказать обаmeasure1а такжеmeasure2в следующий раз?

Подход со скользящим окном также может быть использован в этом случае.

Используя тот же набор данных временных рядов, что и выше, мы можем сформулировать его как контролируемую проблему обучения, где мы предсказываем обаmeasure1а такжеmeasure2с такой же шириной окна, как показано ниже.

X1, X2, y1, y2
?, ?, 0.2, 88
0.2, 88, 0.5, 89
0.5, 89, 0.7, 87
0.7, 87, 0.4, 88
0.4, 88, 1.0, 90
1.0, 90, ?, ?

Не многие контролируемые методы обучения могут обрабатывать предсказание нескольких выходных значений без изменений, но некоторые методы, такие как искусственные нейронные сети, имеют небольшие проблемы.

Мы можем думать о предсказании более чем одного значения как о предсказании последовательности. В этом случае мы предсказывали две разные выходные переменные, но мы могли бы предсказать несколько временных шагов перед одной выходной переменной.

Это называется многоэтапным прогнозированием и рассматривается в следующем разделе.
Раздвижное окно с многошаговым прогнозированием

Количество временных шагов, которые следует прогнозировать, имеет важное значение.

Опять же, традиционно используют разные имена для проблемы в зависимости от количества временных шагов для прогноза:

    Прогноз в один шаг: Здесь прогнозируется следующий шаг по времени (t + 1).
    Многоступенчатый прогноз: Это где два или более будущих временных шагов должны быть предсказаны.

Все примеры, которые мы рассмотрели до сих пор, были одностадийными прогнозами.

Существует несколько способов смоделировать многоэтапное прогнозирование как контролируемую проблему обучения. Мы рассмотрим некоторые из этих альтернативных способов в следующем посте.

На данный момент мы сосредоточены на формировании многошагового прогноза с использованием метода скользящего окна.

Рассмотрим тот же одномерный набор данных временных рядов из первого примера скользящего окна:

time, measure
1, 100
2, 110
3, 108
4, 115
5, 120

Мы можем представить этот временной ряд как двухэтапный набор данных прогнозирования для контролируемого обучения с шириной окна, равной единице, следующим образом:

X1, y1, y2
? 100, 110
100, 110, 108
110, 108, 115
108, 115, 120
115, 120, ?
120, ?, ?

Мы можем видеть, что первый ряд и последние два ряда не могут использоваться для обучения контролируемой модели.

Это также хороший пример, показывающий нагрузку на входные переменные. В частности, что контролируемая модель имеет толькоX1работать с тем, чтобы предсказать какy1а такжеy2,

Чтобы найти ширину окна, обеспечивающую приемлемую производительность модели, необходимо тщательно продумать и поэкспериментировать с вашей проблемой.
Дальнейшее чтение

Если вы ищете дополнительные ресурсы о том, как работать с данными временных рядов как с проблемой машинного обучения, см. Следующие две статьи:

    Машинное обучение для последовательных данных: обзор(2002) [PDF]
    Стратегии машинного обучения для прогнозирования временных рядов(2013) (также слайдыPDF)

Код Python о том, как это сделать, смотрите в посте:

    Как преобразовать временной ряд в контролируемую задачу обучения в Python

Резюме

В этом посте вы узнали, как переопределить проблему прогнозирования временных рядов в качестве контролируемой проблемы обучения для использования с методами машинного обучения.

В частности, вы узнали:

    Контролируемое обучение является наиболее популярным способом формулирования задач для машинного обучения как набора наблюдений с входными и выходными данными.
    Скользящее окно - это способ реструктурировать набор данных временных рядов как контролируемую проблему обучения.
    Временные ряды многомерного и многошагового прогнозирования также могут быть представлены как контролируемое обучение с использованием метода скользящего окна.

У вас есть вопросы по поводу метода раздвижных окон или по поводу этого поста?
Задайте свои вопросы в комментариях ниже, и я сделаю все возможное, чтобы ответить.

Оригинальная статья
